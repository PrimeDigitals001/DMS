<div class="client-container">
  <h2>Clients</h2>

  <div class="top-bar">
    <div class="search-section">
      <p-floatlabel variant="on">
        <input
          pInputText
          id="on_label"
          [(ngModel)]="searchQuery"
          autocomplete="off"
          class="w-full"
        />
        <label for="on_label">Quick search a Client</label>
      </p-floatlabel>
    </div>

    <div class="total">
      <h3>{{ totalClients }}</h3>
      <p>Total number of Clients</p>
    </div>
    <p-button label="Add New Client" (onClick)="showDialog()"> </p-button>
  </div>

  <div class="table-section">
    <h3>All Clients</h3>
    <table>
      <thead>
        <tr>
          <th>Client</th>
          <th>Owner Name</th>
          <th>Phone No.</th>
          <th>Edit</th>
          <th>Delete</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let client of clients | searchFilter : searchQuery">
          <td>{{ client.client }}</td>
          <td>{{ client.ownerName }}</td>
          <td>{{ client.phoneNumber }}</td>
          <td>
            <button
              pButton
              icon="pi pi-pencil"
              class="p-button-rounded p-button-text p-button-info"
              (click)="showDialog(client)"
            ></button>
          </td>
          <td>
            <button
              pButton
              icon="pi pi-trash"
              class="p-button-rounded p-button-text p-button-danger"
              (click)="deleteClient(client._id!)"
            ></button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<p-dialog
  [header]="editMode ? 'Edit Client' : 'Add New Client'"
  [modal]="true"
  [(visible)]="visible"
  [style]="{ width: '30rem' }"
  [contentStyle]="{ overflow: 'visible' }"
>
  <form
    [formGroup]="clientForm"
    (ngSubmit)="editMode ? editClient() : addClient()"
  >
    <span class="p-text-secondary block mb-8">
      Please fill in the client details below.
    </span>

    <div class="flex items-center gap-4 mb-4">
      <label for="client" class="font-semibold w-24">Client Name</label>
      <input
        pInputText
        id="client"
        formControlName="client"
        class="flex-auto"
        placeholder="Enter client name"
      />
    </div>

    <div class="flex items-center gap-4 mb-4">
      <label for="ownerName" class="font-semibold w-24">Owner Name</label>
      <input
        pInputText
        id="ownerName"
        formControlName="ownerName"
        class="flex-auto"
        placeholder="Enter owner name"
      />
    </div>

    <div class="flex items-center gap-4 mb-4">
      <label for="phoneNumber" class="font-semibold w-24">Phone Number</label>
      <input
        pInputText
        id="phoneNumber"
        formControlName="phoneNumber"
        class="flex-auto"
        placeholder="Enter phone number"
      />
    </div>

    <div class="flex items-center gap-4 mb-8">
      <label for="email" class="font-semibold w-24">Email</label>
      <input
        pInputText
        id="email"
        formControlName="email"
        class="flex-auto"
        placeholder="Enter email"
      />
    </div>

    <div class="flex justify-end gap-2">
      <p-button
        type="button"
        label="Cancel"
        severity="secondary"
        (click)="visible = false"
      ></p-button>
      <p-button
        type="submit"
        [label]="editMode ? 'Update Client' : 'Add Client'"
      ></p-button>
    </div>
  </form>
</p-dialog>
